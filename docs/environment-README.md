# Environment Configuration with OMNeT++ (SWIM)

This document explains how to configure the simulated environment used by MAPER through an OMNeT++ configuration file (`swim.ini`). The goal of this file is to define how the environment behaves during simulation, including execution time, workload input, server pool limits, and adaptation-related parameters.

This README focuses only on the most relevant variables for understanding and controlling the adaptive behavior of the system. Parameters that are not directly related to adaptation logic, workload definition, or experimental control are intentionally not explained.

All configuration semantics follow OMNeT++ conventions. For full details about the configuration language itself, refer to the official OMNeT++ manual:
https://doc.omnetpp.org/omnetpp/manual/

---

## Role of the swim.ini File

The `swim.ini` file configures the execution environment in which the SWIM network is simulated. It defines:

- How long the simulation runs
- When measurements start being considered valid
- How requests arrive in the system
- Limits on server scaling
- Parameters that influence adaptation sensitivity

This file does not define adaptation logic itself. Instead, it defines the *context* in which adaptation operates.

---

## Simulation Duration

### sim-time-limit

The variable `sim-time-limit` defines the total duration of the simulation.

Example:

> `sim-time-limit = 600s`

This means the simulation will run for 600 simulated seconds. After this point, execution stops automatically.

This parameter is essential for:
- Comparing experiments consistently
- Ensuring scenarios fully unfold
- Bounding adaptation behavior in time

---

### warmup-period

The variable `warmup-period` defines an initial time window during which collected metrics are ignored.

Example:

> `warmup-period = 15s`

During the first 15 seconds of simulation:
- The system is allowed to stabilize
- Transient startup effects are ignored
- Metrics are not considered for evaluation

This avoids bias caused by initialization artifacts such as empty queues or cold starts.

---

## Workload Input

### source.interArrivalsFile

The variable `*.source.interArrivalsFile` defines the input workload trace used by the simulator.

Example:

> `*.source.interArrivalsFile = ${trace = "traces/scenario.delta"}`

This file contains a list of inter-arrival times, typically generated by a scenario generation tool or notebook.

Each value represents the delay until the next request arrives.

This mechanism allows:
- Deterministic workload replay
- Reproducible experiments
- Precise control over request patterns

The workload shape is entirely defined outside OMNeT++, but consumed here.

---

## Adaptation Sensitivity

### dimmerMargin

The variable `*.dimmerMargin` defines the tolerance margin applied to dimmer-based adaptation decisions.

Example:

> `*.dimmerMargin = 0.1`

This value controls how sensitive the system is to changes in dimmer levels.

Conceptually:
- Smaller values lead to more aggressive adaptation
- Larger values introduce hysteresis and stability

This parameter directly affects how easily the system switches between fidelity or performance modes.

---

## Server Pool Limits

### maxServers

The variable `*.maxServers` defines the maximum number of servers that can be active at any point in time.

Example:

> `*.maxServers = 20`

This is a hard upper bound enforced by the environment. Adaptation logic cannot exceed this limit, regardless of workload pressure.

This parameter models physical or budgetary constraints.

---

### initialServers

The variable `*.initialServers` defines how many servers are active at simulation start.

Example:

> `*.initialServers = 3`

This determines the system’s initial capacity before any adaptation occurs.

Different initial values can significantly influence:
- Early response times
- Initial adaptation decisions
- Convergence behavior

---

## Server Boot Behavior

### bootDelay

The variable `*.bootDelay` defines how long a server takes to become operational after being added.

Example:

> `*.bootDelay = ${latency = 0, 0, 120, 180, 240}`

In this configuration:
- Different simulation runs use different deterministic boot delays
- In our compose, the first variable is always choosen (in this case, 0)
- But, usually, the value is selected via OMNeT++ iteration variables

This models realistic server startup costs and prevents instantaneous scaling.

A commented alternative shows how random boot delays could be modeled, but deterministic values are often preferred for controlled experiments.

---

## What Is Not Explained Here

This document intentionally does not explain:
- Output configuration
- Statistics recording
- Service time distributions
- Brownout internals
- Utility functions
- Scheduler configuration

These parameters are either OMNeT++-specific or orthogonal to the adaptation logic explored by MAPER.

---

## Summary

The `swim.ini` file defines the operational envelope of the adaptive system. By tuning a small set of key parameters—time limits, workload input, scaling bounds, and sensitivity margins—users can explore a wide range of experimental conditions without changing any code.

Understanding these variables is sufficient to design meaningful and reproducible adaptation experiments.
